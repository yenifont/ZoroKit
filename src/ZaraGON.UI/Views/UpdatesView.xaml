<UserControl x:Class="ZaraGON.UI.Views.UpdatesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes">

    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="0">
        <StackPanel Margin="24,20,24,24">
            <!-- Page Header -->
            <DockPanel Margin="0,0,0,0">
                <StackPanel>
                    <TextBlock Text="G&#252;ncellemeler" Style="{StaticResource PageTitleStyle}" />
                    <TextBlock Text="Bile&#351;en g&#252;ncellemelerini kontrol edin" Style="{StaticResource PageSubtitleStyle}" />
                </StackPanel>
                <Button DockPanel.Dock="Right" HorizontalAlignment="Right" VerticalAlignment="Top"
                        Command="{Binding CheckAllUpdatesCommand}"
                        IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"
                        Background="Transparent" BorderThickness="0" Padding="0" Cursor="Hand" Margin="0,6,0,0">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Refresh" Width="13" Height="13" Margin="0,0,5,0"
                                                 Foreground="{StaticResource PrimaryBrush}" VerticalAlignment="Center" />
                        <TextBlock Text="T&#252;m&#252;n&#252; Kontrol Et" FontSize="12" FontWeight="Medium"
                                   Foreground="{StaticResource PrimaryBrush}" VerticalAlignment="Center" />
                    </StackPanel>
                </Button>
            </DockPanel>

            <!-- Component Cards -->
            <ItemsControl ItemsSource="{Binding Components}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Style="{StaticResource CardStyle}" Padding="14,12">
                            <StackPanel>
                                <DockPanel>
                                    <!-- Icon -->
                                    <Border Width="40" Height="40" CornerRadius="11"
                                            Background="{StaticResource PrimaryLightBrush}" Margin="0,0,14,0"
                                            VerticalAlignment="Center">
                                        <materialDesign:PackIcon Kind="{Binding Icon}" Width="20" Height="20"
                                                                 Foreground="{StaticResource PrimaryBrush}"
                                                                 HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>

                                    <!-- Update Button -->
                                    <Button Content="G&#252;ncelle" Style="{StaticResource SuccessButtonStyle}"
                                            Command="{Binding DataContext.UpdateComponentCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}" DockPanel.Dock="Right"
                                            VerticalAlignment="Center" Padding="14,5" FontSize="11.5" Margin="12,0,0,0"
                                            Visibility="{Binding HasUpdate, Converter={StaticResource BooleanToVisibilityConverter}}"
                                            IsEnabled="{Binding IsUpdating, Converter={StaticResource InverseBoolConverter}}" />

                                    <!-- Info -->
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock Text="{Binding Name}" FontSize="13" FontWeight="SemiBold"
                                                   Foreground="{StaticResource PrimaryTextBrush}" />
                                        <TextBlock Foreground="{StaticResource MutedTextBrush}" FontSize="11" Margin="0,2,0,0">
                                            <Run Text="Mevcut:" />
                                            <Run Text="{Binding CurrentVersion, Mode=OneWay}" FontWeight="Medium" />
                                        </TextBlock>
                                        <StackPanel Orientation="Horizontal" Margin="0,2,0,0"
                                                    Visibility="{Binding IsChecked, Converter={StaticResource BooleanToVisibilityConverter}}">
                                            <TextBlock Foreground="{StaticResource MutedTextBrush}" FontSize="11">
                                                <Run Text="Son:" />
                                                <Run Text="{Binding LatestVersion, Mode=OneWay}" FontWeight="Medium" />
                                            </TextBlock>
                                            <!-- Status badge -->
                                            <Border CornerRadius="4" Padding="6,2" Margin="8,0,0,0"
                                                    VerticalAlignment="Center">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Setter Property="Background" Value="{StaticResource InputBackgroundBrush}" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding HasUpdate}" Value="True">
                                                                <Setter Property="Background" Value="{StaticResource SuccessLightBrush}" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <TextBlock FontSize="10" FontWeight="SemiBold">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Text" Value="G&#252;ncel" />
                                                            <Setter Property="Foreground" Value="{StaticResource MutedTextBrush}" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding HasUpdate}" Value="True">
                                                                    <Setter Property="Text" Value="G&#252;ncelleme mevcut" />
                                                                    <Setter Property="Foreground" Value="{StaticResource SuccessBrush}" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </DockPanel>

                                <!-- Checking spinner -->
                                <ProgressBar IsIndeterminate="True" Height="4" Margin="0,8,0,0"
                                             Background="{StaticResource InputBackgroundBrush}"
                                             Foreground="{StaticResource PrimaryBrush}"
                                             Visibility="{Binding IsChecking, Converter={StaticResource BooleanToVisibilityConverter}}" />

                                <!-- Download progress -->
                                <StackPanel Margin="0,8,0,0"
                                            Visibility="{Binding IsUpdating, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <TextBlock Text="{Binding UpdateStatus}" Foreground="{StaticResource PrimaryTextBrush}"
                                               FontSize="11" FontWeight="Medium" />
                                    <ProgressBar Value="{Binding UpdateProgress}" Maximum="100" Height="6"
                                                 Margin="0,4,0,0" Background="{StaticResource InputBackgroundBrush}"
                                                 Foreground="{StaticResource PrimaryBrush}" />
                                </StackPanel>

                                <!-- Status text (when not updating) -->
                                <TextBlock Text="{Binding UpdateStatus}" Foreground="{StaticResource MutedTextBrush}"
                                           FontSize="11" Margin="0,4,0,0">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Visibility" Value="Visible" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsUpdating}" Value="True">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding IsChecking}" Value="True">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding UpdateStatus}" Value="">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- Global status -->
            <TextBlock Text="{Binding StatusMessage}" Foreground="{StaticResource MutedTextBrush}"
                       Margin="2,2,0,0" FontSize="11.5" />
        </StackPanel>
    </ScrollViewer>
</UserControl>
